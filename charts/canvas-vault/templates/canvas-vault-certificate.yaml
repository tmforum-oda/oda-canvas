---
{{ if eq 1 1 }}
apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  # {{ .Release.Name }}-vault-tls can not be used as name, because the extra env variables for hc vault 
  # are defined in values yaml, which does not allow templating 
  name: canvasvault-tls
  namespace: {{ include "canvasvault.namespace" . }}
spec:
  commonName: canvasvault-tls
  dnsNames:
  - canvasvault-tls
  - canvasvault-tls.{{ include "canvasvault.namespace" . }}
  - canvasvault-tls.{{ include "canvasvault.namespace" . }}.svc
  - canvasvault-tls.{{ include "canvasvault.namespace" . }}.svc.cluster.local
  duration: 21600h0m0s
  issuerRef:
    name: canvas-cert-manager-init-selfsigned-cluster
    kind: ClusterIssuer
  privateKey:
    algorithm: RSA
    encoding: PKCS1
    size: 2048
  secretName: canvasvault-tls
  usages:
  - digital signature
  - content commitment
  - key encipherment
  - server auth
  {{- end }}