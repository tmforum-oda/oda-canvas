@startuml
actor KubernetesAPI
participant Operator
participant DeploymentController
participant PDBController
database Kubernetes as K8s

== Deployment Created ==

KubernetesAPI -> Operator: Deployment Created
Operator -> DeploymentController: Reconcile()

DeploymentController -> DeploymentController: Read Annotations
DeploymentController -> DeploymentController: Lookup Matching Policies

DeploymentController -> DeploymentController: Evaluate Advisory Enforcement

alt allowOverride == true and override reason present
    DeploymentController -> DeploymentController: Accept override
    DeploymentController -> Operator: Emit Event (AnnotationAccepted)
else override missing
    DeploymentController -> DeploymentController: Fallback to policy class
    DeploymentController -> Operator: Emit Warning (OverrideRejected)
end

DeploymentController -> PDBController: Create/Update PDB
PDBController -> K8s: Apply PodDisruptionBudget
PDBController -> DeploymentController: Return Success/Failure

DeploymentController -> Operator: Record Metrics
@enduml